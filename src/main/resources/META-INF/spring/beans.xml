<?xml version="1.0"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:camel="http://camel.apache.org/schema/spring" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
       http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring
       http://camel.apache.org/schema/spring/camel-spring.xsd">

	<bean id="jasypt"
		class="org.apache.camel.component.jasypt.JasyptPropertiesParser">
		<property name="password" value="#{systemEnvironment['JASYPT_PASSWORD']}" />
	</bean>

	<bean id="bridgePropertyPlaceholder"
		class="org.apache.camel.spring.spi.BridgePropertyPlaceholderConfigurer">
		<property name="location" value="file:#{systemEnvironment['PROPERTIES']}" />
		<property name='parser' ref='jasypt' />
	</bean>

	<!-- Jetty Security handling -->
	<bean id="authConstraint" class="org.eclipse.jetty.util.security.Constraint">
		<property name="name" value="BASIC" />
		<property name="roles" value="${activedirectory.groupname}" />
		<property name="authenticate" value="true" />
	</bean>

	<bean id="noAuthConstraint" class="org.eclipse.jetty.util.security.Constraint">
		<property name="name" value="BASIC" />
		<property name="authenticate" value="false" />
	</bean>

	<bean id="authConstraintMapping" class="org.eclipse.jetty.security.ConstraintMapping">
		<property name="constraint" ref="authConstraint" />
		<property name="pathSpec" value="/*" />
	</bean>
	<bean id="noAuthConstraintMapping" class="org.eclipse.jetty.security.ConstraintMapping">
		<property name="constraint" ref="noAuthConstraint" />
		<property name="pathSpec" value="/api-doc" />
	</bean>

	<bean id="contextSource" class="org.springframework.ldap.core.support.LdapContextSource">
		<property name="url" value="${ldap.url}" />
		<property name="base" value="${ldap.base}" />
		<property name="userDn" value="${ldap.userDn}" />
		<property name="password" value="${ldap.password}" />
	</bean>

	<bean id="ldapTemplate" class="org.springframework.ldap.core.LdapTemplate">
		<constructor-arg ref="contextSource" />
	</bean>

	<bean id="loginService" class="com.lilly.iep.sec.LoginService">
		<property name="ldapTemplate" ref="ldapTemplate" />
	</bean>

	<bean id="securityHandler" class="org.eclipse.jetty.security.ConstraintSecurityHandler">
		<property name="authenticator">
			<bean class="org.eclipse.jetty.security.authentication.BasicAuthenticator" />
		</property>
		<property name="constraintMappings">
			<list>
				<ref bean="authConstraintMapping" />
				<ref bean="noAuthConstraintMapping" />
			</list>
		</property>
		<property name="loginService" ref="loginService" />
	</bean>

	<!-- WMQ -->
	<bean id="sslv3SocketFactory" class="com.lilly.iep.ssl.SSLv3SocketFactory"
		init-method="init">
		<property name="keyPassword" value="${wmq.sslcontext.keyPassword}" />
		<property name="resource" value="${wmq.sslcontext.keyStore}" />
		<property name="password" value="${wmq.sslcontext.password}" />
	</bean>

	<bean id="wmqConnectionFactory" class="com.ibm.mq.jms.MQQueueConnectionFactory">
		<property name="transportType" value="1" />
		<property name="hostName" value="${wmq.hostname}" />
		<property name="port" value="${wmq.port}" />
		<property name="queueManager" value="${wmq.queuemanager}" />
		<property name="channel" value="${wmq.channel}" />
		<property name="useConnectionPooling" value="true" />
		<property name="SSLSocketFactory" ref="sslv3SocketFactory" />
		<property name="SSLCipherSuite" value="SSL_RSA_WITH_3DES_EDE_CBC_SHA" />
	</bean>

	<bean id="wmqCachingConnectionFactory"
		class="org.springframework.jms.connection.CachingConnectionFactory"
		destroy-method="destroy">
		<property name="targetConnectionFactory" ref="wmqConnectionFactory" />
		<property name="cacheConsumers" value="true" />
		<property name="reconnectOnException" value="true" />
		<property name="sessionCacheSize" value="5" />
	</bean>

	<bean id="wmqOut" class="org.apache.camel.component.jms.JmsComponent">
		<property name="connectionFactory" ref="wmqCachingConnectionFactory" />
		<property name="transacted" value="false" />
		<property name="cacheLevelName" value="CACHE_AUTO" />
	</bean>

	<!-- Database Example -->
	<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
		<property name="url" value="${musicbrainz.jdbc}" />
		<property name="username" value="${musicbrainz.username}" />
		<property name="password" value="${musicbrainz.password}" />
		<property name="driverClassName" value="oracle.jdbc.driver.OracleDriver" />
		<property name="initialSize" value="5" />
		<property name="maxIdle" value="5" />
		<property name="maxActive" value="10" />
		<property name="validationQuery" value="SELECT 1 FROM DUAL" />
	</bean>

	<bean id="dataSourceTemplate"
		class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate">
		<constructor-arg>
			<ref bean="dataSource" />
		</constructor-arg>
	</bean>

	<bean id="dataSourceProcessor" class="com.lilly.esb.iep.alsc.processor.DataSourceProcessor">
		<property name="dataSourceTemplate" ref="dataSourceTemplate" />
		<property name="studyQuery"
			value="${com.lilly.esb.iep.alsc.master.study.query.csv}" />
	</bean>

	<bean id="basicAuthHeaderProcessor"
		class="com.lilly.esb.iep.alsc.processor.BasicAuthHeaderProcessor">
		<property name="soagUser" value="${com.lilly.esb.iep.alsc.soag.username}" />
		<property name="soagPwd" value="${com.lilly.esb.iep.alsc.soag.password}" />
	</bean>

	<bean id="trackerProcessor" class="com.lilly.esb.iep.alsc.processor.IepTrackerProcessor" />

	<bean id="defaultExceptionProcessor"
		class="com.lilly.esb.iep.alsc.common.exception.processor.DefaultExceptionProcessor">
		<property name="logName" value="alsc" />
		<property name="encryptedPassword" value="${com.lilly.esb.iep.alsc.encrypt.password}" />
	</bean>

	<!-- IIP DS -->
	<bean id="iipDs" class="org.apache.commons.dbcp.BasicDataSource">
		<property name="url" value="${com.lilly.esb.iep.alsc.iip.db.url}" />
		<property name="username" value="${com.lilly.esb.iep.alsc.iip.db.username}" />
		<property name="password" value="${com.lilly.esb.iep.alsc.iip.db.password}" />
		<property name="driverClassName"
			value="${com.lilly.esb.iep.alsc.iip.db.driverClassName}" />
		<property name="initialSize"
			value="${com.lilly.esb.iep.alsc.iip.db.conn.initialSize}" />
		<property name="maxIdle"
			value="${com.lilly.esb.iep.alsc.iip.db.conn.maxIdle}" />
		<property name="maxActive"
			value="${com.lilly.esb.iep.alsc.iip.db.conn.maxActive}" />
		<property name="validationQuery"
			value="${com.lilly.esb.iep.alsc.iip.db.conn.validationQuery}" />
	</bean>
	<bean id="iipTemplate"
		class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate">
		<constructor-arg>
			<ref bean="iipDs" />
		</constructor-arg>
	</bean>

	<!-- Study study -->
	<bean id="studyCsvGenerator" class="com.lilly.esb.iep.alsc.bean.StudyCsvGenerator">
		<property name="dataSourceTemplate" ref="iipTemplate" />
		<property name="masterStudyQuery"
			value="${com.lilly.esb.iep.alsc.master.study.query.csv}" />
		<property name="masterStudyHeader"
			value="${com.lilly.esb.iep.alsc.master.study.query.header}" />
		<property name="masterStudyDomain"
			value="${com.lilly.esb.iep.alsc.master.study.query.domain}" />
		<property name="fullPath" value="${com.lilly.esb.iep.alsc.study.fes.fullpath}" />
	</bean>

	<!-- eCTS -->
	<bean id="ectsDs" class="org.apache.commons.dbcp.BasicDataSource">
		<property name="url" value="${com.lilly.esb.iep.alsc.ects.db.url}" />
		<property name="username" value="${com.lilly.esb.iep.alsc.ects.db.username}" />
		<property name="password" value="${com.lilly.esb.iep.alsc.ects.db.password}" />
		<property name="driverClassName"
			value="${com.lilly.esb.iep.alsc.ects.db.driverClassName}" />
		<property name="initialSize"
			value="${com.lilly.esb.iep.alsc.ects.db.conn.initialSize}" />
		<property name="maxIdle"
			value="${com.lilly.esb.iep.alsc.ects.db.conn.maxIdle}" />
		<property name="maxActive"
			value="${com.lilly.esb.iep.alsc.ects.db.conn.maxActive}" />
		<property name="validationQuery"
			value="${com.lilly.esb.iep.alsc.ects.db.conn.validationQuery}" />
	</bean>
	<bean id="ectsTemplate"
		class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate">
		<constructor-arg>
			<ref bean="ectsDs" />
		</constructor-arg>
	</bean>
	<bean id="ectsCsvGenerator" class="com.lilly.esb.iep.alsc.bean.EctsCsvGenerator">
		<property name="dataSourceTemplate" ref="ectsTemplate" />
		<property name="ectsSecureFesStagingDirFullPath"
			value="${com.lilly.esb.iep.alsc.ects.secure.fes.fullpath}" />
		<property name="ectsGeneralFesStagingDirFullPath"
			value="${com.lilly.esb.iep.alsc.ects.general.fes.fullpath}" />

		<property name="trtmnt_grp_desc_query"
			value="${com.lilly.esb.iep.alsc.ects.trtmnt_grp_desc.query}" />
		<property name="trtmnt_grp_desc_header"
			value="${com.lilly.esb.iep.alsc.ects.trtmnt_grp_desc.header}" />
		<property name="trtmnt_grp_desc_domain"
			value="${com.lilly.esb.iep.alsc.ects.trtmnt_grp_desc.domain}" />

		<property name="package_desc_query"
			value="${com.lilly.esb.iep.alsc.ects.package_desc.query}" />
		<property name="package_desc_header"
			value="${com.lilly.esb.iep.alsc.ects.package_desc.header}" />
		<property name="package_desc_domain"
			value="${com.lilly.esb.iep.alsc.ects.package_desc.domain}" />

		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_query"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense.query}" />
		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_header"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense.header}" />
		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_domain"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense.domain}" />

		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_f_query"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense_f.query}" />
		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_f_header"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense_f.header}" />
		<property name="mdf_ss_owner_dtp_sms_treatment_dispense_f_domain"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_treatment_dispense_f.domain}" />

		<property name="mdf_ss_owner_dtp_sms_randomization_query"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization.query}" />
		<property name="mdf_ss_owner_dtp_sms_randomization_header"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization.header}" />
		<property name="mdf_ss_owner_dtp_sms_randomization_domain"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization.domain}" />

		<property name="mdf_ss_owner_dtp_sms_randomization_f_query"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization_f.query}" />
		<property name="mdf_ss_owner_dtp_sms_randomization_f_header"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization_f.header}" />
		<property name="mdf_ss_owner_dtp_sms_randomization_f_domain"
			value="${com.lilly.esb.iep.alsc.ects.mdf_ss_owner.dtp_sms_randomization_f.domain}" />

		<property name="ects_ss_owner_ivrs_sbjct_sts_query"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_sts.query}" />
		<property name="ects_ss_owner_ivrs_sbjct_sts_header"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_sts.header}" />
		<property name="ects_ss_owner_ivrs_sbjct_sts_domain"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_sts.domain}" />

		<property name="ects_ss_owner_ivrs_sbjct_data_query"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_data.query}" />
		<property name="ects_ss_owner_ivrs_sbjct_data_header"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_data.header}" />
		<property name="ects_ss_owner_ivrs_sbjct_data_domain"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_sbjct_data.domain}" />

		<property name="ects_ss_owner_ivrs_site_enroll_query"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_site_enroll.query}" />
		<property name="ects_ss_owner_ivrs_site_enroll_header"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_site_enroll.header}" />
		<property name="ects_ss_owner_ivrs_site_enroll_domain"
			value="${com.lilly.esb.iep.alsc.ects.ects_ss_owner.ivrs_site_enroll.domain}" />
	</bean>

	<!-- LSS -->
	<bean id="lssDs" class="org.apache.commons.dbcp.BasicDataSource">
		<property name="url" value="${com.lilly.esb.iep.alsc.lss.db.url}" />
		<property name="username" value="${com.lilly.esb.iep.alsc.lss.db.username}" />
		<property name="password" value="${com.lilly.esb.iep.alsc.lss.db.password}" />
		<property name="driverClassName"
			value="${com.lilly.esb.iep.alsc.lss.db.driverClassName}" />
		<property name="initialSize"
			value="${com.lilly.esb.iep.alsc.lss.db.conn.initialSize}" />
		<property name="maxIdle"
			value="${com.lilly.esb.iep.alsc.lss.db.conn.maxIdle}" />
		<property name="maxActive"
			value="${com.lilly.esb.iep.alsc.lss.db.conn.maxActive}" />
		<property name="validationQuery"
			value="${com.lilly.esb.iep.alsc.lss.db.conn.validationQuery}" />
	</bean>
	<bean id="lssTemplate"
		class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate">
		<constructor-arg>
			<ref bean="lssDs" />
		</constructor-arg>
	</bean>
	<bean id="lssCsvGenerator" class="com.lilly.esb.iep.alsc.bean.LssCsvGenerator">
		<property name="dataSourceTemplate" ref="lssTemplate" />
		<property name="queryCaseGeneralStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.casegeneralstg.csv}" />
		<property name="headerCaseGeneralStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.casegeneralstg.header}" />
		<property name="domainCaseGeneralStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.casegeneralstg.domain}" />

		<property name="queryEventStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventstg.csv}" />
		<property name="headerEventStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventstg.header}" />
		<property name="domainEventStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventstg.domain}" />

		<property name="queryEventAssessStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventassessstg.csv}" />
		<property name="headerEventAssessStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventassessstg.header}" />
		<property name="domainEventAssessStg"
			value="${com.lilly.esb.iep.alsc.lss.iip.query.eventassessstg.domain}" />
		<property name="fullPath" value="${com.lilly.esb.iep.alsc.lss.fes.fullpath}" />
	</bean>

	<!-- Reference -->
	<bean id="xmlValidator" class="com.lilly.esb.iep.alsc.bean.XmlValidator" />

	<bean id="masterReferenceService" class="com.lilly.esb.iep.alsc.bean.MasterReferenceService">
		<property name="dataSourceTemplate" ref="iipTemplate" />
		<property name="queryReference"
			value="${com.lilly.esb.iep.alsc.master.reference.query}" />
		<property name="partnerResponseSchemaFilePath"
			value="${com.lilly.esb.iep.alsc.validate.schema.partnerResponse}" />
		<property name="alscMasterRefDataSchemaFilePath"
			value="${com.lilly.esb.iep.alsc.validate.schema.alscMasterRefData}" />
		<property name="xmlValidator" ref="xmlValidator" />
	</bean>
	
	<bean id="finalResponseService" class="com.lilly.esb.iep.alsc.bean.FinalResponseService">
        <property name="timeoutMinutes" value="${com.lilly.esb.iep.alsc.frm.timeout.min}" />
        <property name="notes" value="${com.lilly.esb.iep.alsc.frm.notes}" />
        <property name="sourceName" value="${com.lilly.esb.iep.alsc.frm.sourceName}" />
        <property name="targetName" value="${com.lilly.esb.iep.alsc.frm.targetName}" />
    </bean>

	<!-- route -->
	<camel:camelContext id="com.lilly.esb.iep.alsc-camelContext">
		<camel:package>com.lilly.esb.iep.alsc.routebuilder</camel:package>
	</camel:camelContext>

</beans>